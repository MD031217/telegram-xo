<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ 5 –≤ —Ä—è–¥</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            margin-top: 20px;
        }
        
        h1 {
            text-align: center;
            color: white;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            text-align: center;
            color: white;
            font-size: 1.2em;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 0 10px;
        }
        
        .game-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .status {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
            padding: 12px 20px;
            background: #ecf0f1;
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }
        
        .score {
            font-size: 1.1em;
            color: #7f8c8d;
        }
        
        .controls {
            display: flex;
            gap: 12px;
        }
        
        .btn {
            padding: 12px 24px;
            font-size: 1em;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }
        
        .game-area {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }
        
        .board-container {
            flex: 1;
            position: relative;
            background: #f8f9fa;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
            min-height: 700px;
            border: 3px solid #2c3e50;
        }
        
        #gameBoard {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 700px;
            cursor: pointer;
            background: 
                repeating-linear-gradient(0deg, transparent, transparent 39px, #bdc3c7 40px),
                repeating-linear-gradient(90deg, transparent, transparent 39px, #bdc3c7 40px);
            background-size: 40px 40px;
            background-position: center center;
        }
        
        .cell {
            position: absolute;
            width: 40px;
            height: 40px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 50%;
            z-index: 2;
        }
        
        .cell:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: scale(1.1);
        }
        
        .cell::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
        }
        
        .cell.x::before {
            width: 32px;
            height: 32px;
            background: #e74c3c;
            animation: placeStone 0.3s ease;
        }
        
        .cell.o::before {
            width: 32px;
            height: 32px;
            background: #3498db;
            animation: placeStone 0.3s ease;
        }
        
        @keyframes placeStone {
            0% { transform: translate(-50%, -50%) scale(0); }
            70% { transform: translate(-50%, -50%) scale(1.1); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .coordinates {
            position: absolute;
            font-size: 10px;
            color: #95a5a6;
            pointer-events: none;
            z-index: 1;
            background: rgba(255,255,255,0.9);
            padding: 1px 3px;
            border-radius: 2px;
            font-weight: bold;
        }
        
        .center-marker {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #e74c3c;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 1;
            box-shadow: 0 0 0 2px white;
        }
        
        .grid-number {
            position: absolute;
            font-size: 11px;
            color: #7f8c8d;
            font-weight: bold;
            pointer-events: none;
            z-index: 1;
            background: rgba(255,255,255,0.9);
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .sidebar {
            width: 300px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        .view-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .view-btn {
            padding: 10px 15px;
            background: #ecf0f1;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        
        .view-btn:hover {
            background: #3498db;
            color: white;
        }
        
        .last-moves {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .move-item {
            padding: 8px 12px;
            background: white;
            margin-bottom: 8px;
            border-radius: 6px;
            border-left: 3px solid #3498db;
            font-size: 0.9em;
        }
        
        .move-item.x {
            border-left-color: #e74c3c;
        }
        
        .move-item.o {
            border-left-color: #3498db;
        }
        
        .win-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255,255,255,0.95);
            padding: 40px 60px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            z-index: 1000;
            animation: popIn 0.5s ease;
        }
        
        @keyframes popIn {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }
        
        .win-title {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .win-subtitle {
            color: #7f8c8d;
            margin-bottom: 25px;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.05); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }
        
        .board-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 3;
        }
        
        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .game-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .board-container {
                min-height: 500px;
            }
            
            #gameBoard {
                min-height: 500px;
            }
        }
    </style>
</head>
<body>
    <h1>üéØ –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ 5 –≤ —Ä—è–¥</h1>
    <div class="subtitle">–ë–æ–ª—å—à–æ–µ –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ ‚Ä¢ –£–º–Ω—ã–π –±–æ—Ç ‚Ä¢ –í—Å—ë –≤–∏–¥–Ω–æ —Å—Ä–∞–∑—É</div>
    
    <div class="container">
        <div class="game-header">
            <div class="game-info">
                <div class="status" id="status">–í–∞—à —Ö–æ–¥ (–ö—Ä–µ—Å—Ç–∏–∫–∏)</div>
                <div class="score" id="score">–•–æ–¥–æ–≤: 0</div>
            </div>
            <div class="controls">
                <button class="btn btn-primary" onclick="makeBotMove()" id="botMoveBtn">
                    ü§ñ –•–æ–¥ –±–æ—Ç–∞
                </button>
                <button class="btn btn-success" onclick="initGame()" id="resetBtn">
                    üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞
                </button>
            </div>
        </div>
        
        <div class="game-area">
            <div class="board-container">
                <div id="gameBoard">
                    <!-- –ò–≥—Ä–æ–≤–∞—è –¥–æ—Å–∫–∞ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –∑–¥–µ—Å—å -->
                    <div class="center-marker"></div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–π</div>
                    <div class="view-controls">
                        <button class="view-btn" onclick="resetView()">üéØ –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–µ</button>
                        <button class="view-btn" onclick="showLastMove()">üìç –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ö–æ–¥</button>
                        <button class="view-btn" onclick="toggleCoordinates()">üìê –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: –í–∫–ª</button>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title">–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ö–æ–¥—ã</div>
                    <div class="last-moves" id="lastMoves">
                        <div class="move-item">–ò–≥—Ä–∞ –µ—â–µ –Ω–µ –Ω–∞—á–∞–ª–∞—Å—å</div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <div class="sidebar-title">–ü—Ä–∞–≤–∏–ª–∞</div>
                    <div style="font-size: 0.9em; color: #7f8c8d; line-height: 1.5;">
                        <p>‚Ä¢ <strong>–¶–µ–ª—å</strong> - —Å–æ–±—Ä–∞—Ç—å 5 —Å–≤–æ–∏—Ö —Ñ–∏–≥—É—Ä –≤ —Ä—è–¥</p>
                        <p>‚Ä¢ <strong>–í—ã –∏–≥—Ä–∞–µ—Ç–µ –∫—Ä–µ—Å—Ç–∏–∫–∞–º–∏</strong> (–∫—Ä–∞—Å–Ω—ã–µ)</p>
                        <p>‚Ä¢ <strong>–ë–æ—Ç –∏–≥—Ä–∞–µ—Ç –Ω–æ–ª–∏–∫–∞–º–∏</strong> (—Å–∏–Ω–∏–µ)</p>
                        <p>‚Ä¢ –†—è–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º, –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º –∏–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω—ã–º</p>
                        <p>‚Ä¢ –ü–æ–ª–µ –±–æ–ª—å—à–æ–µ - 31√ó31 –∫–ª–µ—Ç–æ–∫</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã - –ë–û–õ–¨–®–û–ï –ü–û–õ–ï
        const CONFIG = {
            WIN_LENGTH: 5,
            CELL_SIZE: 40,
            BOARD_SIZE: 31, // –ë–æ–ª—å—à–æ–µ –ø–æ–ª–µ 31x31 –∫–ª–µ—Ç–æ–∫
            SHOW_ALL: true   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å—ë –ø–æ–ª–µ —Å—Ä–∞–∑—É
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let gameState = {
            board: {},
            currentPlayer: 'x',
            gameOver: false,
            lastMoves: [],
            moveCount: 0,
            showCoordinates: true
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const gameBoard = document.getElementById('gameBoard');
        const statusElement = document.getElementById('status');
        const scoreElement = document.getElementById('score');
        const lastMovesElement = document.getElementById('lastMoves');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            gameState = {
                board: {},
                currentPlayer: 'x',
                gameOver: false,
                lastMoves: [],
                moveCount: 0,
                showCoordinates: true
            };
            
            statusElement.textContent = '–í–∞—à —Ö–æ–¥ (–ö—Ä–µ—Å—Ç–∏–∫–∏)';
            statusElement.style.borderLeftColor = '#e74c3c';
            scoreElement.textContent = '–•–æ–¥–æ–≤: 0';
            updateLastMoves();
            renderBoard();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –í–°–ï–ì–û –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è —Å—Ä–∞–∑—É
        function renderBoard() {
            gameBoard.innerHTML = '';
            
            const center = Math.floor(CONFIG.BOARD_SIZE / 2);
            const boardSize = CONFIG.BOARD_SIZE * CONFIG.CELL_SIZE;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –¥–æ—Å–∫–∏
            gameBoard.style.width = `${boardSize}px`;
            gameBoard.style.height = `${boardSize}px`;
            
            // –°–æ–∑–¥–∞–µ–º –∫–ª–µ—Ç–∫–∏ –¥–ª—è –í–°–ï–ì–û –ø–æ–ª—è
            for (let x = -center; x <= center; x++) {
                for (let y = -center; y <= center; y++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    cell.dataset.x = x;
                    cell.dataset.y = y;
                    
                    // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª–µ)
                    const posX = (x + center) * CONFIG.CELL_SIZE;
                    const posY = (y + center) * CONFIG.CELL_SIZE;
                    
                    cell.style.left = `${posX}px`;
                    cell.style.top = `${posY}px`;
                    
                    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∏–≥—É—Ä
                    const key = `${x},${y}`;
                    if (gameState.board[key]) {
                        cell.classList.add(gameState.board[key]);
                    }
                    
                    // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è —É–≥–ª–æ–≤—ã—Ö –∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö –∫–ª–µ—Ç–æ–∫
                    if (gameState.showCoordinates && 
                        (x === -center || x === 0 || x === center || 
                         y === -center || y === 0 || y === center)) {
                        const coords = document.createElement('div');
                        coords.className = 'coordinates';
                        coords.textContent = `${x},${y}`;
                        coords.style.left = `${CONFIG.CELL_SIZE/2}px`;
                        coords.style.top = `${CONFIG.CELL_SIZE/2}px`;
                        cell.appendChild(coords);
                    }
                    
                    cell.addEventListener('click', () => makeMove(x, y));
                    gameBoard.appendChild(cell);
                }
            }
            
            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä
            const centerMarker = document.createElement('div');
            centerMarker.className = 'center-marker';
            centerMarker.style.left = `${boardSize/2}px`;
            centerMarker.style.top = `${boardSize/2}px`;
            gameBoard.appendChild(centerMarker);
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ü–∏—Ñ—Ä—ã –¥–ª—è –æ—Å–µ–π
            addAxisNumbers();
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–æ–≤ –Ω–∞ –æ—Å–∏
        function addAxisNumbers() {
            const center = Math.floor(CONFIG.BOARD_SIZE / 2);
            
            // –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –æ—Å—å (X)
            for (let x = -center + 2; x <= center - 2; x += 3) {
                if (x === 0) continue;
                
                const numberX = document.createElement('div');
                numberX.className = 'grid-number';
                numberX.textContent = x;
                numberX.style.left = `${(x + center) * CONFIG.CELL_SIZE + CONFIG.CELL_SIZE/2}px`;
                numberX.style.top = `${5}px`;
                gameBoard.appendChild(numberX);
                
                const numberXBottom = document.createElement('div');
                numberXBottom.className = 'grid-number';
                numberXBottom.textContent = x;
                numberXBottom.style.left = `${(x + center) * CONFIG.CELL_SIZE + CONFIG.CELL_SIZE/2}px`;
                numberXBottom.style.bottom = `${5}px`;
                gameBoard.appendChild(numberXBottom);
            }
            
            // –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∞—è –æ—Å—å (Y)
            for (let y = -center + 2; y <= center - 2; y += 3) {
                if (y === 0) continue;
                
                const numberY = document.createElement('div');
                numberY.className = 'grid-number';
                numberY.textContent = y;
                numberY.style.top = `${(y + center) * CONFIG.CELL_SIZE + CONFIG.CELL_SIZE/2}px`;
                numberY.style.left = `${5}px`;
                gameBoard.appendChild(numberY);
                
                const numberYRight = document.createElement('div');
                numberYRight.className = 'grid-number';
                numberYRight.textContent = y;
                numberYRight.style.top = `${(y + center) * CONFIG.CELL_SIZE + CONFIG.CELL_SIZE/2}px`;
                numberYRight.style.right = `${5}px`;
                gameBoard.appendChild(numberYRight);
            }
        }

        // –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ö–æ–¥–∞
        function makeMove(x, y) {
            if (gameState.gameOver || gameState.currentPlayer !== 'x') return;
            
            const key = `${x},${y}`;
            if (gameState.board[key]) return;
            
            gameState.board[key] = 'x';
            gameState.lastMoves.push({ x, y, player: 'x' });
            gameState.moveCount++;
            
            updateLastMoves();
            scoreElement.textContent = `–•–æ–¥–æ–≤: ${gameState.moveCount}`;
            
            if (checkWin(x, y, 'x')) {
                showWinMessage('üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –ø–æ–±–µ–¥–∏–ª–∏!');
                renderBoard();
                return;
            }
            
            gameState.currentPlayer = 'o';
            statusElement.textContent = '–•–æ–¥ –±–æ—Ç–∞ (–ù–æ–ª–∏–∫–∏)...';
            statusElement.style.borderLeftColor = '#3498db';
            
            renderBoard();
            
            // –•–æ–¥ –±–æ—Ç–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
            setTimeout(makeBotMove, 800);
        }

        // –•–æ–¥ –±–æ—Ç–∞
        function makeBotMove() {
            if (gameState.gameOver) return;
            
            const move = findBestMove();
            if (move) {
                const { x, y } = move;
                const key = `${x},${y}`;
                gameState.board[key] = 'o';
                gameState.lastMoves.push({ x, y, player: 'o' });
                gameState.moveCount++;
                
                updateLastMoves();
                scoreElement.textContent = `–•–æ–¥–æ–≤: ${gameState.moveCount}`;
                
                if (checkWin(x, y, 'o')) {
                    showWinMessage('ü§ñ –ë–æ—Ç –ø–æ–±–µ–¥–∏–ª! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!');
                    renderBoard();
                    return;
                }
                
                gameState.currentPlayer = 'x';
                statusElement.textContent = '–í–∞—à —Ö–æ–¥ (–ö—Ä–µ—Å—Ç–∏–∫–∏)';
                statusElement.style.borderLeftColor = '#e74c3c';
                
                renderBoard();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ö–æ–¥–æ–≤
        function updateLastMoves() {
            lastMovesElement.innerHTML = '';
            const recentMoves = gameState.lastMoves.slice(-10).reverse();
            
            if (recentMoves.length === 0) {
                lastMovesElement.innerHTML = '<div class="move-item">–ò–≥—Ä–∞ –µ—â–µ –Ω–µ –Ω–∞—á–∞–ª–∞—Å—å</div>';
                return;
            }
            
            recentMoves.forEach(move => {
                const moveItem = document.createElement('div');
                moveItem.className = `move-item ${move.player}`;
                const playerSymbol = move.player === 'x' ? '‚ùå' : '‚≠ï';
                moveItem.textContent = `${playerSymbol} (${move.x}, ${move.y})`;
                lastMovesElement.appendChild(moveItem);
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ
        function showWinMessage(message) {
            gameState.gameOver = true;
            
            const winMessage = document.createElement('div');
            winMessage.className = 'win-message pulse';
            winMessage.innerHTML = `
                <div class="win-title">${message}</div>
                <div class="win-subtitle">–°–¥–µ–ª–∞–Ω–æ —Ö–æ–¥–æ–≤: ${gameState.moveCount}</div>
                <button class="btn btn-success" onclick="initGame()" style="margin-top: 15px;">
                    üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞
                </button>
            `;
            
            document.body.appendChild(winMessage);
        }

        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–æ–º (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
        function resetView() {
            // –ü–æ–ª–µ –≤—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å—ë, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º
            renderBoard();
        }

        function showLastMove() {
            if (gameState.lastMoves.length > 0) {
                const lastMove = gameState.lastMoves[gameState.lastMoves.length - 1];
                // –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Å—Ç–æ –ø–æ–¥—Å–≤–µ—Ç–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ö–æ–¥
                highlightLastMove(lastMove.x, lastMove.y);
            }
        }

        function toggleCoordinates() {
            gameState.showCoordinates = !gameState.showCoordinates;
            document.querySelector('.view-btn:nth-child(3)').textContent = 
                `üìê –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: ${gameState.showCoordinates ? '–í–∫–ª' : '–í—ã–∫–ª'}`;
            renderBoard();
        }

        function highlightLastMove(x, y) {
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                cell.style.boxShadow = 'none';
            });
            
            const lastCell = document.querySelector(`.cell[data-x="${x}"][data-y="${y}"]`);
            if (lastCell) {
                lastCell.style.boxShadow = '0 0 0 3px gold';
            }
        }

        // –ê–ª–≥–æ—Ä–∏—Ç–º –±–æ—Ç–∞
        function findBestMove() {
            const candidateMoves = new Set();
            
            // –°–æ–±–∏—Ä–∞–µ–º –∫–ª–µ—Ç–∫–∏ –≤–æ–∫—Ä—É–≥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∏–≥—É—Ä
            Object.keys(gameState.board).forEach(key => {
                const [x, y] = key.split(',').map(Number);
                for (let dx = -2; dx <= 2; dx++) {
                    for (let dy = -2; dy <= 2; dy++) {
                        if (dx === 0 && dy === 0) continue;
                        const newX = x + dx;
                        const newY = y + dy;
                        const newKey = `${newX},${newY}`;
                        if (!gameState.board[newKey]) {
                            candidateMoves.add(newKey);
                        }
                    }
                }
            });
            
            // –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ, –Ω–∞—á–∏–Ω–∞–µ–º —Å —Ü–µ–Ω—Ç—Ä–∞
            if (candidateMoves.size === 0) return { x: 0, y: 0 };
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏
            const movesArray = Array.from(candidateMoves).map(key => {
                const [x, y] = key.split(',').map(Number);
                return { x, y, score: evaluatePosition(x, y, 'o') };
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –æ—Ü–µ–Ω–∫–µ –∏ –±–µ—Ä–µ–º –ª—É—á—à–∏–π —Ö–æ–¥
            movesArray.sort((a, b) => b.score - a.score);
            return movesArray[0];
        }

        // –û—Ü–µ–Ω–∫–∞ –ø–æ–∑–∏—Ü–∏–∏
        function evaluatePosition(x, y, player) {
            let score = 0;
            const opponent = player === 'x' ? 'o' : 'x';
            
            const directions = [
                { dx: 1, dy: 0 }, { dx: 0, dy: 1 }, 
                { dx: 1, dy: 1 }, { dx: 1, dy: -1 }
            ];
            
            directions.forEach(dir => {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è —Ä—è–¥–æ–≤
                for (let i = -4; i <= 0; i++) {
                    let playerCount = 0;
                    let opponentCount = 0;
                    let emptyCount = 0;
                    
                    for (let j = 0; j < 5; j++) {
                        const checkX = x + dir.dx * (i + j);
                        const checkY = y + dir.dy * (i + j);
                        const key = `${checkX},${checkY}`;
                        
                        if (gameState.board[key] === player) playerCount++;
                        else if (gameState.board[key] === opponent) opponentCount++;
                        else emptyCount++;
                    }
                    
                    // –û—Ü–µ–Ω–∏–≤–∞–µ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª –ª–∏–Ω–∏–∏
                    if (playerCount === 4 && emptyCount === 1) score += 1000;
                    else if (playerCount === 3 && emptyCount === 2) score += 100;
                    else if (opponentCount === 4 && emptyCount === 1) score += 800;
                    else if (opponentCount === 3 && emptyCount === 2) score += 80;
                    else if (playerCount === 2) score += 10;
                }
            });
            
            // –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ —Ü–µ–Ω–Ω–µ–µ
            const distanceFromCenter = Math.abs(x) + Math.abs(y);
            score += Math.max(0, 20 - distanceFromCenter);
            
            return score;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–±–µ–¥—ã
        function checkWin(x, y, player) {
            const directions = [
                { dx: 1, dy: 0 }, { dx: 0, dy: 1 }, 
                { dx: 1, dy: 1 }, { dx: 1, dy: -1 }
            ];
            
            for (const dir of directions) {
                let count = 1;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
                for (let i = 1; i < CONFIG.WIN_LENGTH; i++) {
                    const checkX = x + dir.dx * i;
                    const checkY = y + dir.dy * i;
                    if (gameState.board[`${checkX},${checkY}`] === player) {
                        count++;
                    } else {
                        break;
                    }
                }
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
                for (let i = 1; i < CONFIG.WIN_LENGTH; i++) {
                    const checkX = x - dir.dx * i;
                    const checkY = y - dir.dy * i;
                    if (gameState.board[`${checkX},${checkY}`] === player) {
                        count++;
                    } else {
                        break;
                    }
                }
                
                if (count >= CONFIG.WIN_LENGTH) return true;
            }
            
            return false;
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        window.addEventListener('load', initGame);
    </script>
</body>
</html>
